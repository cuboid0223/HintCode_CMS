(function(V,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("react"),require("@firecms/core"),require("react/jsx-runtime"),require("@firecms/ui"),require("react-fast-compare")):typeof define=="function"&&define.amd?define(["exports","react","@firecms/core","react/jsx-runtime","@firecms/ui","react-fast-compare"],l):(V=typeof globalThis<"u"?globalThis:V||self,l(V.FireCMS={},V.React,V.core,V.jsxRuntime,V.ui,V.equal))})(this,function(V,l,g,o,c,R){"use strict";function ee(e,t=""){return e?Object.entries(e).flatMap(([n,a])=>{const s=t?`${t}.${n}`:n;return typeof a=="object"?ee(a,s):{[s]:a}}).reduce((n,a)=>({...n,...a}),{}):{}}const te="https://api-drplyi3b6q-ey.a.run.app";async function le(e){const t=ee(e.values),n=e.properties,s={inputEntity:{entityId:e.entityId,values:t},properties:n,entityName:e.entityName,entityDescription:e.entityDescription,propertyKey:e.propertyKey,propertyInstructions:e.propertyInstructions,instructions:e.instructions};return console.debug("enhanceDataAPIStream",s),fetch((e.host??te)+"/data/enhance_stream/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Basic ${e.firebaseToken}`,"x-de-api-key":`Basic ${e.apiKey}`},body:JSON.stringify(s)}).then(async r=>{if(!r.ok)throw console.error("enhanceDataAPIStream error",r),await r.json();const i=r.body?.getReader();if(!i)throw new Error("No reader");for await(const d of ce(i)){const m=new TextDecoder().decode(d);try{m.split("&$# ").forEach(u=>{if(u&&u.length>0){const y=JSON.parse(u.trim());y.type==="suggestion_delta"&&e.onUpdateDelta(y.data.propertyKey,y.data.partialValue),y.type==="suggestion"&&e.onUpdate(y.data),y.type==="result"&&e.onEnd(y.data)}})}catch(u){console.error("str",m),console.error("Error parsing stream",u),e.onError(u)}}})}function ce(e){return{async*[Symbol.asyncIterator](){let t=await e.read();for(;!t.done;)yield t.value,t=await e.read()}}}async function de(e){return console.debug("fetchEntityPromptSuggestion",e),fetch((e.host??te)+"/data/prompt_autocomplete/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Basic ${e.firebaseToken}`,"x-de-api-key":`Basic ${e.apiKey}`},body:JSON.stringify({entityName:e.entityName,input:e.input??null})}).then(async t=>{const n=await t.json();if(console.debug("fetchEntityPromptSuggestion data",n),!t.ok)throw console.error("fetchEntityPromptSuggestion",n),Error(n.message);return{prompts:n.data.prompts.map(a=>({prompt:a,type:"sample"}))}})}function ne(e,t){const n=typeof e=="string"&&typeof t=="string"&&e.toLowerCase().trim().startsWith(t.toLowerCase().trim());return typeof t=="string"&&n?e.substr(e.toLowerCase().trim().indexOf(t.toLowerCase().trim())+t.trim().length):void 0}function ue(e,t,n=""){return e?Object.entries(e).map(([a,s])=>{if(g.isPropertyBuilder(s))return{};const r=n?`${n}.${a}`:a,i=g.getValueInPath(t,r);return Q(s,r,i)}).reduce((a,s)=>({...a,...s}),{}):{}}function X(e){const t=g.getFieldId(e);if(!t)throw console.error("No fieldId found for property",e),new Error("Field id not found");return{name:e.name,description:e.description,dataType:e.dataType,fieldConfigId:t,enumValues:"enumValues"in e&&e.enumValues?ge(e.enumValues):void 0,disabled:!!(e.disabled||e.readOnly)}}function Q(e,t,n){if(g.isPropertyBuilder(e))return{};if(e.dataType==="array"){if(e.of&&!g.isPropertyBuilder(e.of)){const a={name:e.name,description:e.description,dataType:e.dataType,fieldConfigId:"repeat",disabled:!!(e.disabled||e.readOnly),of:X(e.of)};return{[t]:a}}else if(e.oneOf){const a={name:e.name,description:e.description,dataType:e.dataType,fieldConfigId:"block",disabled:!!(e.disabled||e.readOnly),oneOf:{typeField:e.oneOf.typeField,valueField:e.oneOf.valueField,properties:Object.entries(e.oneOf.properties).map(([s,r])=>({[s]:X(r)})).reduce((s,r)=>({...s,...r}),{})}};return Array.isArray(n)?n.map((s,r)=>{const i=e.oneOf.typeField??"type",d=s[i],m=e.oneOf.valueField??"value",u=s[m],y=e.oneOf.properties[d];if(y===void 0)return console.error(`No property found for type ${d}`,e.oneOf.properties),{};const h=Q(y,`${t}.${r}.${m}`,u);return{[`${t}.${r}.${i}`]:d,...h}}).reduce((s,r)=>({...s,...r}),{[t]:a}):{[t]:a}}}else if(e.dataType==="map"){if(e.properties){const a=Object.entries(e.properties).map(([r,i])=>{const d=n?.[r];return Q(i,r,d)}).map(r=>fe(r,t)).reduce((r,i)=>({...r,...i}),{});if(Object.keys(a).length===0)return{};const s={name:e.name,description:e.description,dataType:e.dataType,fieldConfigId:"group",disabled:!!(e.disabled||e.readOnly)};return{[t]:s,...a}}}else return g.getFieldId(e)?{[t]:X(e)}:(console.warn(`No fieldId found for property ${t} with dataType ${e.dataType}`),{});return{}}function fe(e,t=""){return Object.entries(e).map(([n,a])=>({[t?`${t}.${n}`:n]:a})).reduce((n,a)=>({...n,...a}),{})}function ge(e){if(Array.isArray(e))return e.map(t=>String(t.id));if(typeof e=="object")return Object.keys(e);throw Error("getSimpleEnumValues: Invalid enumValues")}function he({projectId:e}){return o.jsxs("div",{className:"flex flex-col space-y-1 p-1",children:[o.jsx(c.Typography,{variant:"h6",children:"Subscription required"}),o.jsx(c.Typography,{children:"You have finished your free usage quota."}),o.jsx(c.Typography,{children:"You need an active subscription in order to continue using the plugin"}),o.jsx(c.Button,{href:`https://app.firecms.co/subscriptions?projectId=${e}`,color:"primary",component:"a",rel:"noopener noreferrer",target:"_blank",children:"Create a subscription"})]})}const re=l.createContext({}),ae=()=>l.useContext(re);function Z(e,t){if(t in e)return e[t];{const n=t.split(".");if(n.length===1)return;const a=n.slice(0,n.length-1).join(".");return Z(e,a)}}function pe({apiKey:e,getConfigForPath:t,children:n,host:a,path:s,collection:r,formContext:i,SubscriptionMessage:d=he}){const[m,u]=l.useState(!1),[y,h]=l.useState({}),[I,w]=l.useState([]),b=g.useFireCMSContext(),j=g.useCustomizationController(),P=l.useRef(!1),$=g.useAuthController(),x=g.useSnackbarController(),B=g.resolveCollection({collection:r,path:s,entityId:i?.entityId,values:i?.values,fields:j.propertyConfigs}),A=l.useMemo(()=>ue(B.properties,i?.values),[i?.values]),v=l.useRef(i?.values??{});l.useEffect(()=>{P.current||(v.current=i?.values??{})},[i?.values]);const C=!1,F=l.useCallback(async()=>{if(!t)return;t({path:s,collection:r})&&u(!0)},[r,t,s]);l.useEffect(()=>{t?F():u(!0)},[t,F]);const N=g.useDataSource(r),q=g.useNavigationController(),Y=l.useCallback(p=>{h(T=>{const{[p]:M,...k}=T;return k})},[]),G=(p,T)=>{const M=Z(A,p);if(T===null||M?.disabled)return;const k=g.getValueInPath(v.current,p),D=(k?k+"":"")+T;v.current={...v.current,[p]:D},i?.setFieldValue(p,D,!1),h(O=>({...O,[p]:(O[p]??"")+T}))},z=(p,T,M)=>{w(k=>k.filter(E=>!Object.keys(T).includes(E))),Object.entries(T).forEach(([k,E])=>{const D=g.getValueInPath(p,k),O=Z(A,k);if(!O||E===null||O.disabled)return;if(typeof E=="number"){i?.setFieldValue(k,E);return}if(M){i?.setFieldValue(k,E);return}const S=ne(E,D),L=D?D+"":"";if(S)i?.setFieldValue(k,E);else{const Ne=O?.fieldConfigId==="multiline"||O?.fieldConfigId==="markdown",K=L.trimEnd();Ne&&(K.endsWith(".")||K.endsWith("?")||K.endsWith("!")||K.endsWith(":"))?i?.setFieldValue(k,K+`

`+E.trimStart()):i?.setFieldValue(k,K+(K.length>0?" ":"")+E)}}),h(k=>({...k,...Object.keys(T).reduce((E,D)=>{const O=g.getValueInPath(i?.values,D),S=T[D];return{...E,[D]:ne(S,O)??S}},{})}))};function H(p){x.open({type:"warning",message:o.jsx(d,{projectId:p,context:b}),autoHideDuration:4e3})}const f=async p=>{if(!$.user)return x.open({type:"warning",message:"You need to be logged in to enhance data"}),Promise.reject(new Error("Not logged in"));const T=q.resolveAliasesFrom(s),M=await $.getAuthToken();p.propertyKey?Y(p.propertyKey):_(),w(E=>[...E,...p.propertyKey?[p.propertyKey]:Object.keys(A)]),P.current=!0;const k=v.current??{};return new Promise((E,D)=>{function O(S){if(w([]),S.code==="payment-required"){const L=S.data.projectId;H(L)}else console.error("Enhance error",S);D(S),P.current=!1}try{le({...p,host:a,apiKey:e,properties:A,path:T,entityName:r.singularName??r.name,entityDescription:r.description,dataSource:N,firebaseToken:M,onUpdate:S=>{console.debug("de onUpdate",S),z(k,S,p.replaceValues??!1)},onUpdateDelta:(S,L)=>{G(S,L)},onError:O,onEnd:S=>{console.debug("de onEnd",S),S.errors&&S.errors.forEach(L=>{x.open({type:"warning",message:L})}),Object.keys(S.suggestions).length===0&&x.open({type:"info",autoHideDuration:1800,message:"No fields were updated"}),w([]),E(S),P.current=!1}}).catch(O)}catch(S){O(S)}})},_=l.useCallback(()=>{h({})},[]),W=l.useCallback(async(p,T)=>{const M=await $.getAuthToken();return de({host:a,entityName:p,firebaseToken:M,apiKey:e,input:T})},[e,$.getAuthToken]),U={enabled:m,suggestions:y,clearSuggestion:Y,enhance:f,allowReferenceDataSelection:C,clearAllSuggestions:_,getSamplePrompts:W,loadingSuggestions:I};return o.jsx(re.Provider,{value:U,children:n})}const me=["text_field","number_input","multiline","markdown","email","select"];function ye({value:e,setValue:t,label:n,inputType:a,multiline:s=!1,highlight:r,disabled:i,error:d,size:m="medium",className:u}){const y=l.useRef(null),h=l.useRef(null),[I,w]=l.useState(e?e.toString():"");l.useEffect(()=>{w(e?e.toString():"")},[e]);const b=l.useCallback(C=>{h.current&&(h.current.scrollTop=C.target.scrollTop,h.current.scrollLeft=C.target.scrollLeft)},[]),[j,P]=l.useState(document.activeElement===y.current),$=I!=null&&I!=="",x=!!r&&(e===r||String(e).endsWith(r)),B=x?String(e).substring(0,String(e).length-r.length):I,A=l.useCallback(C=>{const F=C.target.value;if(a==="number")if(F==="-"||F.startsWith(".")||F.endsWith("."))w(F);else{const N=F?parseFloat(F):void 0;N&&isNaN(N)?(t(null),w("")):N!=null?(t(N),w(N.toString())):(t(null),w(""))}else t(F),w(F)},[a,t]);if(l.useCallback(C=>{C.target.blur(),C.stopPropagation(),setTimeout(()=>{C.target.focus()},0)},[]),i)return o.jsx(c.TextField,{label:n,disabled:!0,value:I});const v={onKeyPress:C=>{!s&&C.key==="Enter"&&C.preventDefault()}};return o.jsxs("div",{className:c.cn("rounded-md relative max-w-full",c.fieldBackgroundMixin,i?c.fieldBackgroundDisabledMixin:c.fieldBackgroundHoverMixin,d?"border border-red-500 dark:border-red-600":"",{"min-h-[48px]":m==="small","min-h-[64px]":m==="medium"},u),children:[n&&o.jsx(c.InputLabel,{className:c.cn("absolute top-1 pointer-events-none",d?"text-red-500 dark:text-red-600":j?"text-primary":"text-text-secondary dark:text-text-secondary-dark",i?"opacity-50":""),shrink:$||j,children:n}),o.jsxs("div",{ref:h,className:"inset-0 whitespace-pre-wrap min-h-16 overflow-x-auto select-none pt-8 pb-2 px-3",children:[se(B,!x&&s),x&&o.jsx("span",{className:"dark:bg-slate-700 bg-slate-300 p-px -m-px rounded-sm",children:se(r,s)})]}),o.jsx(c.TextareaAutosize,{className:c.cn(c.focusedMixin,m==="small"?"min-h-[48px]":"min-h-[64px]","rounded-md resize-none w-full outline-none p-[32px] text-base bg-transparent px-3 pt-[28px]",i&&"border border-transparent outline-none opacity-50 text-gray-600 dark:text-gray-500","absolute top-0 right-0 left-0 max-w-full bg-transparent text-transparent caret-gray-800 dark:caret-gray-200","pt-8 pb-2 px-3"),ignoreBoxSizing:!0,ref:y,onFocus:()=>P(!0),onBlur:()=>P(!1),value:I,sizeRef:h,onChange:A,onScroll:b,...v})]})}function se(e,t=!1){if(typeof e=="number"||e===void 0)return e;if(typeof e!="string")return console.error("addLineBreaks: value is not a string",e),"";const n=e.split(`
`);return n.length===1?o.jsx("span",{className:"break-words",children:e??" "}):n.map((a,s)=>o.jsxs(l.Fragment,{children:[o.jsx("span",{className:"break-words",children:a??" "}),(n.length-1!==s||t)&&o.jsx("br",{})]},s))}const be=l.memo(function({value:t,setValue:n,error:a,showError:s,disabled:r,autoFocus:i,property:d,propertyKey:m,includeDescription:u,highlight:y}){let h=!1;d.dataType==="string"&&(h=(d.multiline||d.markdown)??!1),g.useClearRestoreValue({property:d,value:t,setValue:n});const I=t??(d.dataType==="string"?"":t===0?0:"");return o.jsxs(o.Fragment,{children:[o.jsx(ye,{inputType:d.dataType==="number"?"number":"text",label:o.jsx(g.LabelWithIcon,{icon:g.getIconForProperty(d),title:(d.name??"")+(d.validation?.required?" *":"")}),value:I,multiline:h,highlight:y,setValue:n,disabled:r,error:s}),o.jsx(g.FieldHelperText,{includeDescription:u,showError:s,error:a,disabled:r,property:d})]})},(e,t)=>e.value===t.value&&e.error===t.error&&e.showError===t.showError&&e.disabled===t.disabled&&R(e.property,t.property)&&e.highlight===t.highlight);function oe(e,t){let n=0;for(const a in e){const s=e[a],r=t[a];r&&!r.disabled&&(r.dataType==="string"||r.dataType==="number"?n+=String(s).length:r.dataType==="array"&&Array.isArray(s)&&r.of?.dataType==="string"?n+=s.reduce((i,d)=>i+(d?.length??0),0):r.dataType==="map"&&r.properties&&typeof s=="object"&&(n+=oe(s,r.properties)))}return n}function Se(e){const{fieldConfigId:t,property:n}=e;return n.disabled||n.readOnly||n.Field?null:me.includes(t)?Ie(e):null}function Ie({fieldConfigId:e,Field:t}){return function(a){const{enabled:s,suggestions:r,enhance:i,loadingSuggestions:d}=ae(),m=d?.includes(a.propertyKey),u=r?.[a.propertyKey],h=oe(a.context.values,a.context.collection.properties)>5;return o.jsx(we,{loading:m,props:a,suggestedValue:u,enabled:s,enoughData:h,Field:t,enhance:i})}}const we=l.memo(function({loading:t,props:n,suggestedValue:a,enabled:s,enoughData:r,Field:i,enhance:d}){const[m,u]=l.useState(!1),[y,h]=l.useState(!1),[I,w]=l.useState(!1),[b,j]=l.useState();if(!s)return o.jsx(i,{...n});const P=!n.disabled&&(!n.value||n.property.dataType==="string"&&(n.property.multiline||n.property.markdown)),x=n.property.dataType==="string"&&!n.property.enumValues&&!n.property.markdown?o.jsx(be,{...n,highlight:a}):o.jsx(i,{...n}),B=v=>{if(n.context.entityId&&r)return w(!1),u(!0),d({entityId:n.context.entityId,propertyKey:n.propertyKey,propertyInstructions:v,values:n.context.values,replaceValues:!1}).finally(()=>u(!1))},A=n.property.dataType==="string"&&!n.property.enumValues;return o.jsxs("div",{className:"relative",children:[x,P&&o.jsx("div",{className:"dark:bg-gray-700 bg-gray-100 rounded-full absolute right-2 -top-4",children:o.jsx(c.Tooltip,{open:y,onOpenChange:h,side:"left",title:r?`Autofill ${n.property.name??"this field"}`:`You need to input some data in the form before enhancing ${n.property.name??"this field"}`,children:o.jsxs(c.Menu,{open:I,onOpenChange:w,trigger:o.jsx(c.IconButton,{size:"small","aria-label":"Enhance field",disabled:m||t,className:r?"text-gray-900 dark:text-white":"text-gray-400 dark:text-gray-600",onClick:()=>{if(n.context.entityId&&r)return h(!1),u(!0),d({entityId:n.context.entityId,propertyKey:n.propertyKey,values:n.context.values,replaceValues:!1}).finally(()=>u(!1))},children:m||t?o.jsx(c.CircularProgress,{size:"small"}):o.jsx(c.AutoAwesomeIcon,{size:"small"})}),children:[o.jsxs(c.MenuItem,{onClick:()=>B(),children:[o.jsx(c.AutoAwesomeIcon,{size:"small"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsxs(c.Typography,{variant:"body2",children:[" ",`Autofill ${n.property.name??"this field"}`]}),o.jsx(c.Typography,{variant:"caption",children:"based on the rest of the entity"})]})]}),A&&o.jsx("div",{className:"p-4",children:o.jsx(c.TextField,{label:"Ask AI to write",size:"small",className:"w-[400px] max-w-full",value:b??"",onKeyDown:v=>{v.key==="Enter"&&B(b)},placeholder:"Instructions",onChange:v=>j(v.target.value),endAdornment:o.jsx(c.IconButton,{size:"small",onClick:()=>B(b),disabled:!b,children:o.jsx(c.SendIcon,{size:"small"})})})})]})})})]})},(e,t)=>e.loading===t.loading&&e.suggestedValue===t.suggestedValue&&e.enabled===t.enabled&&e.props.value===t.props.value&&e.props.error===t.props.error&&e.props.showError===t.props.showError&&e.props.disabled===t.props.disabled&&R(e.props.property,t.props.property)&&e.Field===t.Field&&e.enoughData===t.enoughData);function ie(e,t){let n=0;for(const a in e){const s=e[a],r=t[a];r&&!r.disabled&&(r.dataType==="string"||r.dataType==="number"?n+=s?String(s).length:0:r.dataType==="array"&&Array.isArray(s)&&r.of?.dataType==="string"?n+=s.reduce((i,d)=>i+(d?.length??0),0):r.dataType==="map"&&r.properties&&typeof s=="object"&&(n+=ie(s,r.properties)))}return n}const Te=52;function ke({entityId:e,path:t,status:n,collection:a,formContext:s}){const r=l.useRef(null),[i,d]=l.useState(n),m=Ce(t,i),[u,y]=l.useState(!1),h=ae(),[I,w]=l.useState(void 0),[b,j]=l.useState(""),[P,$]=l.useState(Te),{inputFocused:x,autoCompleteOpen:B,setAutoCompleteOpen:A}=c.useAutoComplete({ref:r}),v=l.useMemo(()=>ve(a.singularName??a.name,I),[I]),{suggestions:C,getSamplePrompts:F}=h,N=l.useRef(!1),q=l.useCallback(async function(_){if(N.current)return;N.current=!0;const W=i==="new"?(await F(a.singularName??a.name,_)).prompts:Ee(a.properties),U=J(m),p=U.map(T=>T.prompt);w([...U,...W.filter(T=>!p.includes(T.prompt))].slice(0,5)),N.current=!1},[a.name,a.singularName,F,i]),Y=l.useDeferredValue(s?.values),G=ie(Y,a.properties)>20;l.useEffect(()=>{I||(w(J(m)),q().then())},[I,m,q,b,i]),l.useEffect(()=>{q().then()},[i]);const z=f=>{if(!(!e||!s?.values))return y(!0),A(!1),f&&(xe(m,f),w([{prompt:f,type:"recent"},...(I??[]).slice(0,5)])),h.enhance({entityId:e,values:s.values,instructions:f,replaceValues:!0}).finally(()=>{y(!1)})};if(!h?.enabled)return null;Object.values(C).filter(Boolean).length>0,(I??[]).length>0&&b.length;const H=!s?.entityId;return o.jsx("div",{className:"relative w-full",style:{height:P},children:o.jsx("div",{className:"absolute flex flex-col items-center w-full font-medium text-sm",children:o.jsxs("form",{className:c.cn(c.defaultBorderMixin,"border-b","flex w-full items-center gap-2 pr-4 pl-6",x?"text-primary":"text-gray-700 dark:text-gray-200"),onSubmit:f=>{A(!1),f.preventDefault(),z(b)},children:[o.jsx(c.AutoFixHighIcon,{}),o.jsx(c.TextareaAutosize,{className:"flex-grow w-full resize-none w-full outline-none py-5 mx-2 bg-transparent",ref:r,value:b,autoFocus:n==="new",disabled:u||H,onResize:f=>{$(f.outerHeightStyle)},placeholder:H?"Please set an ID first":v?.prompt,onClick:()=>{B||A(!0)},onKeyDown:f=>{f.key==="Enter"&&!f.shiftKey&&(f.preventDefault(),z(b)),f.key==="Escape"&&B&&(A(!1),f.preventDefault())},onChange:f=>{H||j(f.target.value)}}),o.jsx(c.Autocomplete,{open:B,setOpen:A,children:I?.map((f,_)=>o.jsxs(c.AutocompleteItem,{onClick:()=>{j(f.prompt),z(f.prompt)},children:[o.jsx("div",{className:"flex-grow",children:f.prompt}),f.type==="recent"&&o.jsx(c.IconButton,{onClick:W=>{W.preventDefault(),W.stopPropagation(),Ae(m,f.prompt),w((I??[]).filter(U=>U.prompt!==f.prompt))},size:"small",children:o.jsx(c.ClearIcon,{size:"small"})})]},_+"_"+f.prompt))}),!u&&b&&o.jsx(c.IconButton,{size:"small",onClick:()=>{j(""),r.current?.focus()},color:x||!b?"primary":void 0,disabled:u,children:o.jsx(c.ClearIcon,{size:"small"})}),(u||b)&&o.jsxs(c.IconButton,{onClick:()=>z(b),size:"large",color:x||!b?"primary":void 0,className:c.cn(b?"":"!bg-slate-50 dark:!bg-slate-800"),disabled:u,children:[u&&o.jsx(c.CircularProgress,{size:"small"}),!u&&b&&o.jsx(c.SendIcon,{color:"primary"})]}),!u&&!b&&o.jsx(c.Tooltip,{title:G?"Try to fill the missing fields. You can use the prompt to give specific instructions":"You need to input some data in the form before enhancing this entity, or use the prompt to give specific instructions",children:o.jsxs(c.Button,{variant:"outlined",size:"small",onClick:()=>z(),disabled:!G||u,children:[o.jsx(c.AutoAwesomeIcon,{color:"primary"}),"Autofill"]})})]})})})}function Ee(e){const t=Object.values(e).filter(s=>g.isPropertyBuilder(s)?!1:s.dataType==="string"&&(s.markdown||s.multiline)),n=t.length>0?t[Math.floor(Math.random()*t.length)]:void 0,a=["Fill the missing fields","Translate the missing content"];return n&&a.push(`Add 2 paragraphs to '${n.name}'`),a.map(s=>({prompt:s,type:"sample"}))}function ve(e,t){const n=(t??[]).length>0?t:["e.g. I want to generate a new document about...","e.g. Add a paragraph to the description",`e.g. Generate a new ${g.singular(e)} related to...`].map(a=>({prompt:a,type:"sample"}));return n[Math.floor(Math.random()*n.length)]}const Ce=(e,t)=>`data_enhancement::${t==="new"?"new":"existing"}::${g.stripCollectionPath(e)}`,J=e=>{const t=localStorage.getItem(e);return t?JSON.parse(t).map(n=>({prompt:n,type:"recent"})):[]},xe=(e,t)=>{if(!t||t.trim().length===0)return;const n=J(e);localStorage.setItem(e,JSON.stringify([t,...n.map(a=>a.prompt).filter(a=>a!==t).slice(0,5)]))},Ae=(e,t)=>{localStorage.setItem(e,JSON.stringify(J(e).map(n=>n.prompt).filter(n=>n!==t)))},Fe="fcms-U9jdDii0xXWSDC34asfrf54lbkFJBfKfRWcEDEwdc4V5wDWEDF";function Oe(e){const t=e?.apiKey??Fe,n=e?.getConfigForPath,a=g.useAuthController(),s=l.useCallback(r=>n?n({path:r.path,collection:r.collection,user:a.user}):!0,[n,a.user]);return{key:"data_enhancement",form:{Actions:ke,provider:{Component:pe,props:{apiKey:t,getConfigForPath:n,SubscriptionMessage:e?.SubscriptionMessage,host:e?.host}},fieldBuilder:Se,fieldBuilderEnabled:s},homePage:{extraProps:{getConfigForPath:n}}}}V.useDataEnhancementPlugin=Oe,Object.defineProperty(V,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.umd.js.map
